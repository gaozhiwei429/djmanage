!function(e,t,n){var i={selectMod:1,selectIds:[],callback:null},o={selectGoods:e("#tpl_popup_selectGoods").html()},a=null,c={},s={getItem:"/Design/getItem"},l=function(t,n,i){"point_exchange"==n.rtype?s.getItem="/Ump/point_exchange_subgroup":s.getItem="/Design/getItem",e.ajax({url:s.getItem+"?v="+Math.round(100*Math.random()),type:"POST",dataType:"json",data:i,beforeSend:function(){e.jBox.showloading()},success:function(s){if(1==s.status){a=s.list;var l=_.template(o.selectGoods,{dataset:s.list,classlists:s.class_lists,page:s.page,formdata:i,selectMod:n.selectMod,selectIds:n.selectIds,curPageCache:c[i.p]}),r=e(l);t.find(".jbox-container").empty().html(r)}else HYD.hint("danger","获取数据失败，"+s.msg),e.jBox.close(t);e.jBox.hideloading()}})},r=function(e){var t=e.attr("href");if(t.length){var n=t.split("/"),i=n[n.length-1].replace(/.html/,"");return i}};_QV_="%E6%9D%AD%E5%B7%9E%E5%90%AF%E5%8D%9A%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E7%89%88%E6%9D%83%E6%89%80%E6%9C%89",e.selectGoods=function(t){var n=e.extend(!0,{},i,t);console.log(n);var o="选择商品";"point_exchange"==n.rtype&&(o="选择积分兑换商品"),a=null,c={},e.jBox.show({title:o,width:1e3,minHeight:605,content:"",onOpen:function(t){l(t,n,{ac_type:n.ac_type?n.ac_type:void 0,p:1});var i=function(){var n=t.find(".paginate a.cur").text(),i=[],o=[];t.find(".j-chkbox:checked").each(function(){var t=e(this),n=t.data("itemid"),c=t.data("index"),s=a[c];i.push(n),o.push(s)}),c[n]={ids:i,data:o}};t.on("click",".paginate a",function(){if(!e(this).hasClass("cur")){i();var o=r(e(this)),a=t.find("input[name=title]").val(),c=t.find("input[name=goods_no]").val(),s=t.find("select[name=status]").val(),d=t.find("select[name=class_id]").val();return l(t,n,{p:o,title:a,goods_no:c,status:s,class_id:d,ac_type:n.ac_type?n.ac_type:void 0}),!1}}),t.on("click",".j-search",function(){var e=t.find("input[name=title]").val(),i=t.find("input[name=goods_no]").val(),o=t.find("select[name=status]").val(),a=t.find("select[name=class_id]").val();l(t,n,{ac_type:n.ac_type?n.ac_type:void 0,p:1,title:e,goods_no:i,status:o,class_id:a})}),1==n.selectMod?t.on("click",".j-select",function(){var i=e(this).data("index");n.callback&&n.callback(a[i]),e.jBox.close(t)}):(t.on("click",".j-select",function(){var t=e(this),n=t.siblings(".j-chkbox");t.hasClass("cur")?(t.removeClass("cur"),n.attr("checked",!1)):(t.addClass("cur"),n.attr("checked",!0))}),t.on("click",".j-use",function(){i();var o=[],a=[];for(var s in c)o=o.concat(c[s].ids),a=a.concat(c[s].data);n.callback&&n.callback(a,o),e.jBox.close(t)}),t.on("click",".j-selectAll",function(){t.find(".j-select").addClass("cur"),t.find(".j-chkbox").attr("checked",!0)}),t.on("click",".j-selectReverse",function(){t.find(".j-select").each(function(){var t=e(this),n=t.siblings(".j-chkbox");t.hasClass("cur")?(t.removeClass("cur"),n.attr("checked",!1)):(t.addClass("cur"),n.attr("checked",!0))})}),t.on("click",".j-cancelSelectAll",function(){t.find(".j-select").removeClass("cur"),t.find(".j-chkbox").attr("checked",!1)}))},btnOK:{show:!1},btnCancel:{show:!1}})}}(jQuery,document,window),$(function(){var e=null,t=null,n=null,i={content:"",callback:null};$.composeBox=function(o){var a=$.extend(!0,{},i,o),c=$("#tpl_popup_selectCompose").html(),s=$(c);$("body").append(s);var l=($(".J-composeBox").height(),$(window).height());$("body").append('<div class="box-overlay"></div>'),$(".box-overlay").css("height",l);var r=$(window).height(),d=$(".compose_top").height(),g=$("#tmpl h2").height(),u=r-d-g;s.find(".compose_lists").css({height:u,overflow:"auto"});var p=function(){$(".J-composeBox").remove(),$(".box-overlay").remove(),$("body").css({height:"auto",overflow:"auto"})};renderData(s,"10"),s.on("click",".J-okClk",function(){a.content=e.getContent(),t=a.content,n=html_encode(a.content),a.callback&&a.callback(t,n),p(),e.destroy()}),s.on("click",".J-noClk",function(){p(),e.destroy()}),s.find("#nav li").click(function(){var e=$(this),t=e.data("id");e.addClass("active").siblings().removeClass("active"),renderData(s,t)}),s.on("click",".compose_lists li",function(){var t=$(this).find(".pEditor").html()+"<p></p>";e.focus(),e.execCommand("inserthtml",t)}),e=UE.getEditor("edit_content",{autoHeight:!1,autoHeightEnabled:!1,autoClearinitialContent:!1,initialFrameHeight:u-74}),"<p>『微排版编辑器』</p>"==a.content&&(a.content=""),e.ready(function(){e.setContent(a.content)})},_QV_="%E6%9D%AD%E5%B7%9E%E5%90%AF%E5%8D%9A%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E7%89%88%E6%9D%83%E6%89%80%E6%9C%89",renderData=function(e,t){$.ajax({url:"/Public/mockdata/composedata/dataset"+t+".json?v="+Math.round(100*Math.random()),type:"GET",dataType:"json",beforeSend:function(){$.jBox.showloading()},success:function(t){if(1==t.status){var n=$("#tpl_Compose_lists").html(),i=_.template(n,{dataset:t.data}),o=$(i);$("#tmpl .compose_lists").empty().append(o)}else HYD.hint("danger","获取数据失败，"),$.jBox.close(e);$.jBox.hideloading()}})},html_encode=function(e){var t="";return 0==e.length?"":(t=e.replace(/&/g,"&amp;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=t.replace(/ /g,"&nbsp;"),t=t.replace(/\'/g,"&#39;"),t=t.replace(/\"/g,"&quot;"))},html_decode=function(e){var t="";return 0==e.length?"":(t=e.replace(/&amp;/g,"&"),t=t.replace(/&lt;/g,"<"),t=t.replace(/&gt;/g,">"),t=t.replace(/&nbsp;/g," "),t=t.replace(/&#39;/g,"'"),t=t.replace(/&quot;/g,'"'))}});var HYD=HYD?HYD:{};HYD.Constant=HYD.Constant?HYD.Constant:{},HYD.popbox=HYD.popbox?HYD.popbox:{},HYD.linkType={1:"选择商品",2:"商品分组",3:"专题页面",4:"页面分类",5:"营销活动",6:"店铺主页",7:"会员主页",8:"分销申请",9:"购物车",10:"全部商品",12:"商品分类",13:"我的订单",111:"自定义链接"},HYD.getTimestamp=function(){var e=new Date;return""+e.getFullYear()+parseInt(e.getMonth()+1)+e.getDate()+e.getHours()+e.getMinutes()+e.getSeconds()+e.getMilliseconds()},HYD.hint=function(e,t,n){if(e&&t){var i=$("#tpl_hint").html(),o=_.template(i,{type:e,content:t}),a=$(o),c=200,n=n||1500;$("body").append(a.css({opacity:"0",zIndex:"999999"})),a.animate({opacity:1,top:200},c,function(){setTimeout(function(){a.animate({opacity:0,top:600},c,function(){$(this).remove()})},n)})}},HYD.FormShowError=function(e,t,n){e&&t&&(void 0==n&&(n=!0),e.addClass("error").siblings(".fi-help-text").addClass("error").text(t).show(),n&&e.focus(),"select"==e[0].nodeName.toLowerCase()&&e.siblings(".select-sim").addClass("error"),e.one("change",function(){HYD.FormClearError($(this))}))},HYD.FormClearError=function(e){e&&(e.removeClass("error").siblings(".fi-help-text").hide(),"select"==e[0].nodeName.toLowerCase()&&e.siblings(".select-sim").removeClass("error"))},HYD.showQrcode=function(e){var t=$("#qrcode");if(!t.length){var n=_.template($("#tpl_qrcode").html(),{src:e});t=$(n),t.click(function(){t.fadeOut(300)}),$("body").append(t)}t.find("img").attr("src",e),t.fadeIn(300)},HYD.changeWizardStep=function(e,t){var n=$(e),i=n.find(".wizard-item");i.removeClass("process complete");for(var o=0;o<=t-1;o++)i.filter(":eq("+o+")").addClass("complete");i.filter(":eq("+t+")").addClass("process")},HYD.autoLocation=function(e,t){if(e){var t=t?t:2e3;timer=setInterval(function(){t<=1e3?(clearInterval(timer),window.location.href=e):(t-=1e3,$("#j-autoLocation-second").text(t/1e3))},1e3)}},HYD.ajaxPopTable=function(e){var t,n,i={title:"",url:"",data:{p:1},tpl:"",onOpen:null,onPageChange:null},o=$.extend(!0,{},i,e),a=$("<div></div>"),c=function(e){var i=o.tpl,s=o.url,l=function(s){t=s;var l=_.template(i,s),r=$(l);a.empty().append(r),a.find(".paginate a:not(.disabled,.cur)").click(function(){for(var e=$(this).attr("href"),t=e.split("/"),n=0;n<t.length;n++)if("p"==t[n]){o.data.p=t[n+1],c();break}return!1}),e&&e(),o.onPageChange&&o.onPageChange(n,t)};$.ajax({url:s+"?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:o.data,success:function(e){1==e.status?l(e):HYD.hint("danger","对不起，获取数据失败："+e.msg)}})};c(function(){$.jBox.show({title:o.title,content:a,btnOK:{show:!1},btnCancel:{show:!1},onOpen:function(e){n=e,o.onOpen&&o.onOpen(e,t)}})})},HYD.popbox.ImgPicker=function(e){var t,n=$("#tpl_popbox_ImgPicker").html(),i=$(n),o=function(e,n){var a=function(e){if(t=e.list,t&&t.length){var a=_.template($("#tpl_popbox_ImgPicker_listItem").html(),{dataset:t}),c=$(a);c.filter("li").click(function(){$(this).toggleClass("selected")}),i.find(".imgpicker-list").empty().append(c);var s=e.page,l=$(s);l.filter("a:not(.disabled,.cur)").click(function(){var e=$(this).attr("href"),t=e.split("/");return t=t[t.length-1],t=t.replace(/.html/,""),o(t),!1}),i.find(".paginate").empty().append(l)}else i.find(".imgpicker-list").append("<p class='txtCenter'>对不起，暂无图片</p>");n&&n()};$.ajax({url:"/Design/getImg?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{p:parseInt(e)},success:function(e){1==e.status?a(e):HYD.hint("danger","对不起，获取数据失败："+e.msg)}})},a=function(t){var n=[];i.find("#imgpicker_upload_input").uploadifive({auto:!0,formData:{PHPSESSID:$.cookie("PHPSESSID")},width:60,height:60,multi:!0,uploadScript:"/Design/uploadFile",buttonText:"上传图片",fileSizeLimit:"5MB",fileType:"image/jpg,image/jpeg,image/png,image/gif,image/bmp",onFallback:function(){HYD.hint("danger","请使用支持html5上传的浏览器")},onUploadComplete:function(e,t){var t=$.parseJSON(t),o=$("#tpl_popbox_ImgPicker_uploadPrvItem").html(),a=i.find(".imgpicker-upload-preview"),c=t.file_path;n.push(c);var s=_.template(o,{url:c}),l=$(s);l.find(".j-imgpicker-upload-btndel").click(function(){var e=i.find(".imgpicker-upload-preview li").index($(this).parent("li"));l.fadeOut(300,function(){n.splice(e,1),$(this).remove()})}),a.append(l)},onError:function(e){"FILE_SIZE_LIMIT_EXCEEDED"==e?e="文件大小超出5MB":"FORBIDDEN_FILE_TYPE"==e?e="文件类型不正确":"404_FILE_NOT_FOUND"==e&&(e="404文件没找到"),HYD.hint("danger","对不起："+file.name+"上传失败："+e)}}),i.find("#j-btn-uploaduse").click(function(){e&&e(n),$.jBox.close(t)})};o(1,function(){$.jBox.show({title:"选择图片",content:i,btnOK:{show:!1},btnCancel:{show:!1},onOpen:function(n){var o=i.find("#j-btn-listuse");o.click(function(){var o=[];i.find(".imgpicker-list li.selected").each(function(){o.push(t[$(this).index()])}),e&&e(o),$.jBox.close(n)}),i.find(".j-initupload").one("click",function(){a(n)})}})})},HYD.popbox.IconPicker=function(e){var t,n=$("#icon_imgPicker").html(),i=$(n);t=$.browser.chrome?"body":document.documentElement||document.body,$(t).append(i);var o=$("#icon_imglist").html(),a={style:"style1",color:"color0"},c=function(e){a=e?e:a;var t=_.template(o,{data:HYD.popbox.iconimgsrc.data[a.style][a.color]});i.find(".albums-icon-tab").html(t),i.find(".albums-icon-tab").find("li").click(function(e){var t=$(this);t.hasClass("selected")||t.addClass("selected").siblings("li").removeClass("selected")})};c(a),i.find(".albums-cr-actions").children("a").click(function(e){var t=$(this),n=t.data("style");a.style=n,t.addClass("cur").siblings("a").removeClass("cur"),c(a)}),i.find(".albums-color-tab").find("li").click(function(e){var t=$(this),n=t.data("color");a.color=n,t.addClass("cur").siblings("li").removeClass("cur"),c(a),"color1"==n&&$(".albums-icon-tab").find("li").css({background:"#333"})});var s=[];i.find("#j-useIcon").click(function(t){var n=i.find(".albums-icon-tab").find("li.selected");if(0==n.length)return HYD.hint("danger","对不起，请选择一张小图标"),!1;var o=n.children("img").attr("src");o=o.replace("Public","PublicMob"),s.push(o),l(),e&&e(s)});var l=function(){i.remove()};i.find("#Jclose").click(function(e){l()})},HYD.popbox.ModulePicker=function(e,t){var n,i=$("#tpl_popbox_ModulePicker").html(),o=$(i),a=function(e,i){var c=function(e){if(n=e.list,n&&n.length){var t=$("#tpl_popbox_ModulePicker_item").html(),c=_.template(t,{dataset:n}),s=$(c);o.find(".modulePicker-list").empty().append(s);var l=e.page,r=$(l);r.filter("a:not(.disabled,.cur)").click(function(){var e=$(this).attr("href"),t=e.split("/");return t=t[t.length-1],t=t.replace(/.html/,""),a(t),!1}),o.find(".paginate").empty().append(r)}else o.find(".modulePicker-list").append("<p class='txtCenter'>对不起，暂无自定义模块</p>");i&&i()};$.ajax({url:"/Design/getModule?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{p:parseInt(e),type:t},success:function(e){1==e.status?c(e):HYD.hint("danger","对不起，获取数据失败："+e.msg)}})};a(1,function(){$.jBox.show({title:"选择自定义模块",content:o,btnOK:{show:!1},btnCancel:{show:!1},onOpen:function(t){o.on("click",".j-select",function(){var i=$(".modulePicker-list li").index($(this).parent("li"));e&&e(n[i]),$.jBox.close(t)})}})})},HYD.popbox.GoodsAndGroupPicker=function(e,t){var n,i,o=$("#tpl_popbox_GoodsAndGroupPicker").html(),a=$(o),c=[],s=[],l=function(e,t){var i=function(e){if(n=e.list,n&&n.length){var i=$("#tpl_popbox_GoodsAndGroupPicker_goodsitem").html(),o=_.template(i,{dataset:n}),r=$(o);r.find(".j-select").click(function(){var e,t=$(this),i=t.parent("li"),o=i.index(),a=i.data("item"),l=$(".j-verify").val();if(e=""!=l?l.split(","):[],i.hasClass("selected")){if(i.removeClass("selected"),t.removeClass("btn-success").text("选取"),0!=c.length)for(var r=0;r<c.length;r++)if(a==c[r].item_id){c.splice(r,1);break}if(0!=s.length)for(var r=0;r<s.length;r++){var d=s[r];if(a==d){s.splice(r,1);break}}if(0!=e.length){for(var r=0;r<e.length;r++){var d=e[r];if(a==d){e.splice(r,1);break}}l=e.join(","),$(".j-verify").val(l)}}else i.addClass("selected"),t.addClass("btn-success").text("已选"),c.push(n[o]),s.push(a),e.push(a),l=e.join(","),$(".j-verify").val(l)}),a.find(".gagp-goodslist").empty().append(r);var d=e.page,g=$(d);g.filter("a:not(.disabled,.cur)").click(function(){var e=$(this).attr("href"),t=e.split("/");return t=t[t.length-1],t=t.replace(/.html/,""),l(t),!1}),a.find(".paginate:eq(0)").empty().append(g)}else a.find(".gagp-goodslist").append("<p class='txtCenter'>对不起，暂无数据</p>");var u=[];""!=$(".j-verify").val()?u=$(".j-verify").val().split(","):$(".img-list li").not(".img-list-add").each(function(e,t){var n=$(this).data("item");u.push(n)}),a.find("li").each(function(e,t){var n=$(this),i=n.data("item");$.each(u,function(e,t){i==t&&(n.addClass("selected"),n.children(".j-select").addClass("btn-success").text("已选"))})}),t&&t()};$.ajax({url:"/Design/getItem?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{p:parseInt(e)},success:function(e){1==e.status?i(e):HYD.hint("danger","对不起，获取数据失败："+e.msg)}})},r=function(e,t){var n=function(e){if(i=e.list,i&&i.length){var n=$("#tpl_popbox_GoodsAndGroupPicker_groupitem").html(),o=_.template(n,{dataset:i}),c=$(o);a.find(".gagp-grouplist").empty().append(c);var s=e.page,l=$(s);l.filter("a:not(.disabled,.cur)").click(function(){var e=$(this).attr("href"),t=e.split("/");return t=t[t.length-1],t=t.replace(/.html/,""),r(t),!1}),a.find(".paginate").empty().append(l)}else a.find(".gagp-grouplist").append("<p class='txtCenter'>对不起，暂无数据</p>");var d=$(".badge-success").data("group");void 0!=d&&a.find(".gagp-grouplist li").each(function(e,t){var n=$(this),i=n.data("group");d==i&&n.find(".j-select").addClass("btn-success").text("已选")}),t&&t()};$.ajax({url:"/Design/getGroup?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{p:parseInt(e)},success:function(e){1==e.status?n(e):HYD.hint("danger","对不起，获取数据失败："+e.msg)}})},d=function(e,n){a.on("click",".j-btn-goodsuse",function(){var n=1;t&&t(c,n,s),$.jBox.close(e)})},g=function(e){var i=1;a.find(".j-btn-goodsuse").remove(),a.on("click",".gagp-goodslist .j-select",function(){var o=$(".gagp-goodslist li").index($(this).parent("li"));t&&t(n[o],i),$.jBox.close(e)})},u=function(e){var n=2;a.on("click",".gagp-grouplist .j-select",function(){var o=$(".gagp-grouplist li").index($(this).parent("li"));t&&t(i[o],n),$.jBox.close(e)})},p=function(e){g(e),a.find(".j-tab-group").one("click",function(){r(1,function(){u(e)})})};switch(e){case"goods":case"goodsMulti":a.find(".tabs").remove(),a.find(".gagp-goodslist").unwrap().unwrap(),a.find(".tc[data-index='2']").remove(),l(1,function(){var t='<span class="fl">选择商品</span><div class="goodsearch"><input type="text" name="title" placeholder="请输入商品名称" /><select class="select small newselect" style="width:90px;"><option value="-1">在售中</option><option value="3">仓库中</option></select><a href="javascript:;" class="btn btn-primary jGetgood"><i class="gicon-search white"></i>查询</a></div>';$.jBox.show({title:t,content:a,btnOK:{show:!1},btnCancel:{show:!1},onOpen:function(t){if("goodsMulti"==e){var i=[];$(".img-list li").not(".img-list-add").each(function(e,t){var n=$(this).data("item");i.push(n)}),a.find("li").each(function(e,t){var n=$(this),o=n.data("item");$.each(i,function(e,t){o==t&&(n.addClass("selected"),n.children(".j-select").addClass("btn-success").text("已选"))})}),d(t,i)}else g(t);$(document).on("click",".jGetgood",function(e){var t=$(this).siblings("input").val(),i=$(this).siblings("select").val(),o=function(e,l){e=e?e:1;var r=function(e){if(n=e.list,n&&n.length){var t=$("#tpl_popbox_GoodsAndGroupPicker_goodsitem").html(),i=_.template(t,{dataset:n}),r=$(i);r.find(".j-select").click(function(){var e,t=$(this),i=t.parent("li"),o=i.index(),a=i.data("item"),l=$(".j-verify").val();if(e=""!=l?l.split(","):[],i.hasClass("selected")){if(i.removeClass("selected"),t.removeClass("btn-success").text("选取"),0!=c.length)for(var r=0;r<c.length;r++)if(a==c[r].item_id){c.splice(r,1);break}if(0!=s.length)for(var r=0;r<s.length;r++){var d=s[r];if(a==d){s.splice(r,1);break}}if(0!=e.length){for(var r=0;r<e.length;r++){var d=e[r];if(a==d){e.splice(r,1);break}}l=e.join(","),$(".j-verify").val(l)}}else i.addClass("selected"),t.addClass("btn-success").text("已选"),c.push(n[o]),s.push(a),e.push(a),l=e.join(","),$(".j-verify").val(l)}),a.find(".gagp-goodslist").empty().append(r);var d=e.page,g=$(d);g.filter("a:not(.disabled,.cur)").click(function(){var e=$(this).attr("href"),t=e.split("/");return t=t[t.length-1],t=t.replace(/.html/,""),o(t),!1}),a.find(".paginate:eq(0)").empty().append(g)}else a.find(".gagp-goodslist").empty().append("<p class='txtCenter'>对不起，暂无数据</p>"),a.find(".paginate").empty();l&&l()};$.ajax({url:"/Design/getItem?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{p:parseInt(e),title:t,status:i},success:function(e){1==e.status?r(e):HYD.hint("danger","对不起，获取数据失败："+e.msg)}})};o()})}})});break;case"group":a.find(".tabs").remove(),a.find(".gagp-grouplist").unwrap().unwrap(),a.find(".tc[data-index='1']").remove(),r(1,function(){$.jBox.show({title:"选择商品分组",content:a,btnOK:{show:!1},btnCancel:{show:!1},onOpen:function(e){u(e)}})});break;case"all":l(1,function(){$.jBox.show({title:"选择商品或商品分组",content:a,btnOK:{show:!1},btnCancel:{show:!1},onOpen:function(e){p(e)}})})}},HYD.popbox.MgzAndMgzCate=function(e,t,n){var i,o,a=$("#tpl_popbox_MgzAndMgzCate").html(),c=$(a),s=function(e,t){var o=function(e){if(i=e.list,i&&i.length){var n=$("#tpl_popbox_MgzAndMgzCate_item").html(),o=_.template(n,{dataset:i}),a=$(o);a.find(".j-select").click(function(){var e=$(this),t=e.parent("li"),n=t.data("id");console.log(n),t.hasClass("selected")?(t.removeClass("selected"),e.removeClass("btn-success").text("选取")):(t.addClass("selected"),e.addClass("btn-success").text("已选"))}),c.find(".mgz-list-panel1").empty().append(a);var l=e.page,r=$(l);r.filter("a:not(.disabled,.cur)").click(function(){var e=$(this).attr("href"),t=e.split("/");return t=t[t.length-1],t=t.replace(/.html/,""),s(t),!1}),c.find(".paginate").empty().append(r)}else c.find(".mgz-list-panel1").empty().append("<p class='txtCenter'>对不起，暂无数据</p>");t&&t()};$.ajax({url:"/Design/getMagazine?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{p:parseInt(e),type:n},success:function(e){1==e.status?o(e):HYD.hint("danger","对不起，获取数据失败："+e.msg)}})},l=function(e,t){var n=function(e){if(o=e.list,o&&o.length){var n=$("#tpl_popbox_MgzAndMgzCate_item").html(),i=_.template(n,{dataset:o}),a=$(i);a.find(".j-select").click(function(){var e=$(this),t=e.parent("li");t.hasClass("selected")?(t.removeClass("selected"),e.removeClass("btn-success").text("选取")):(t.addClass("selected"),e.addClass("btn-success").text("已选"))}),c.find(".mgz-list-panel2").empty().append(a);var s=e.page,r=$(s);r.filter("a:not(.disabled,.cur)").click(function(){var e=$(this).attr("href"),t=e.split("/");return t=t[t.length-1],t=t.replace(/.html/,""),l(t),!1}),c.find(".paginate").empty().append(r)}else c.find(".mgz-list-panel2").empty().append("<p class='txtCenter'>对不起，暂无数据</p>");t&&t()};$.ajax({url:"/Design/getMagazineCategory?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{p:parseInt(e)},success:function(e){1==e.status?n(e):HYD.hint("danger","对不起，获取数据失败："+e.msg)}})},r=function(e){c.on("click",".mgz-list-panel1 .j-select",function(){var n=$(".mgz-list-panel1 li").index($(this).parent("li"));t&&t(i[n],3),$.jBox.close(e)})},d=function(e){c.on("click",".mgz-list-panel2 .j-select",function(){var n=$(".mgz-list-panel2 li").index($(this).parent("li"));t&&t(o[n],4),$.jBox.close(e)})},g=function(e){c.on("click",".j-btn-use",function(){var n=[],i=4;c.find(".mgz-list-panel2 li.selected").each(function(){n.push(o[$(this).index()])}),t&&t(n,i),$.jBox.close(e)})},u=function(e){r(e),c.find(".j-tab-mgzcate").one("click",function(){l(1,function(){d(e)})})};switch(e){case"mgzCate":c.find(".tabs").remove(),c.find(".mgz-list-panel2").unwrap().unwrap(),c.find(".tc[data-index='1']").remove(),c.find(".j-btn-use").remove(),l(1,function(){$.jBox.show({title:"选择专题分类",content:c,btnOK:{show:!1},btnCancel:{show:!1},onOpen:function(e){d(e)}})});break;case"mgzCateMulti":c.find(".tabs").remove(),c.find(".mgz-list-panel2").unwrap().unwrap(),c.find(".tc[data-index='1']").remove(),l(1,function(){$.jBox.show({title:"选择专题分类",content:c,btnOK:{show:!1},btnCancel:{show:!1},onOpen:function(e){g(e)}})});break;case"mgz":c.find(".tabs").remove(),c.find(".mgz-list-panel1").unwrap().unwrap(),c.find(".tc[data-index='2']").remove(),c.find(".j-btn-use").remove(),s(1,function(){$.jBox.show({title:"选择专题页面",content:c,btnOK:{show:!1},btnCancel:{show:!1},onOpen:function(e){u(e)}})});break;case"all":c.find(".j-btn-use").remove(),s(1,function(){$.jBox.show({title:"选择专题页面或者分类",content:c,btnOK:{show:!1},btnCancel:{show:!1},onOpen:function(e){u(e)}})})}switch(e){case"goods":case"goodsMulti":c.find(".tabs").remove(),c.find(".gagp-goodslist").unwrap().unwrap(),c.find(".tc[data-index='2']").remove(),showListRender_goods(1,function(){$.jBox.show({title:"选择商品",content:c,btnOK:{show:!1},btnCancel:{show:!1},onOpen:function(t){"goodsMulti"==e?selectEvent_goods_multi(t):selectEvent_goods(t)}})});break;case"group":c.find(".tabs").remove(),c.find(".gagp-grouplist").unwrap().unwrap(),c.find(".tc[data-index='1']").remove(),showListRender_group(1,function(){$.jBox.show({title:"选择商品分组",content:c,btnOK:{show:!1},btnCancel:{show:!1},onOpen:function(e){selectEvent_group(e)}})});break;case"all":showListRender_goods(1,function(){$.jBox.show({title:"选择商品或商品分组",content:c,btnOK:{show:!1},btnCancel:{show:!1},onOpen:function(e){selectEvent_goodsAndGroup(e)}})})}},HYD.popbox.GamePicker=function(e,t){var n=$("#tpl_popbox_GamePicker").html(),i=$(n),o={1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[]},a=function(e,t,n){var c=function(t){if(o[e]=t.list,o[e]&&o[e].length){var c=$("#tpl_popbox_GamePicker_item").html(),s=_.template(c,{dataset:o[e]}),l=$(s);l.find(".j-select").click(function(){var e=$(this),t=e.parent("li");t.hasClass("selected")?(t.removeClass("selected"),e.removeClass("btn-success").text("选取")):(t.addClass("selected"),e.addClass("btn-success").text("已选"))}),i.find(".game-list-panel"+e).empty().append(l);var r=t.page,d=$(r);d.filter("a:not(.disabled,.cur)").click(function(){var t=$(this).attr("href"),n=t.split("/");return n=n[n.length-1],n=n.replace(/.html/,""),a(e,n),!1}),i.find(".paginate:eq("+(e-1)+")").empty().append(d)}else i.find(".game-list-panel"+e).empty().append("<p class='txtCenter'>对不起，暂无数据</p>");n&&n(e)},s={1:1,2:4,3:3,4:5,5:7,6:8,7:9,8:10};$.ajax({url:"/Design/getGame?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{p:parseInt(t),type:parseInt(s[e])},success:function(e){1==e.status?c(e):HYD.hint("danger","对不起，获取数据失败："+e.msg)}})},c=function(e,n){i.on("click",".game-list-panel"+n+" .j-select",function(){var i=$(".game-list-panel"+n+" li").index($(this).parent("li"));t&&t(o[n][i],5),$.jBox.close(e)})};a(1,1,function(e){$.jBox.show({title:"选择营销活动",content:i,btnOK:{show:!1},btnCancel:{show:!1},onOpen:function(t){c(t,e),i.find(".j-tab-game").one("click",function(){var e=$(this).data("index");a(e,1,function(e){c(t,e)})})}})})},HYD.popbox.dplPickerColletion=function(e){var t={linkType:1,callback:null},n=$.extend(!0,{},t,e);switch(parseInt(n.linkType)){case 1:$.selectGoods({selectMod:1,callback:function(e){n.callback(e,1)}});break;case 2:HYD.popbox.GoodsAndGroupPicker("group",n.callback);break;case 3:HYD.popbox.MgzAndMgzCate("mgz",n.callback,n.smallType);break;case 4:HYD.popbox.MgzAndMgzCate("mgzCate",n.callback);break;case 5:HYD.popbox.GamePicker("all",n.callback);break;case 6:var i={title:"店铺主页",link:"/Shop/index"};n.callback(i,6);break;case 7:var i={title:"会员主页",link:"/User/index"};n.callback(i,7);break;case 8:var i={title:"分销申请",link:"/User/dist_apply"};n.callback(i,8);break;case 9:var i={title:"购物车",link:" /Item/cart"};n.callback(i,9);break;case 10:var i={title:"全部商品",link:" /Item/lists"};n.callback(i,10);break;case 11:case 111:var i={title:"",link:""};n.callback(i,11);break;case 12:var i={title:"商品分类",link:"/Item/item_class"};n.callback(i,12);break;case 13:var i={title:"我的订单",link:"/Order/lists"};n.callback(i,13);break;case 14:var i={title:"",link:""};n.callback(i,14)}},HYD.ajaxPopTable=function(e){var t,n,i={title:"",url:"",width:"auto",minHeight:"auto",data:{p:1},tpl:"",onOpen:null,onPageChange:null},o=$.extend(!0,{},i,e),a=$("<div></div>"),c=function(e){var i=o.tpl,s=o.url,l=function(s){t=s;var l=_.template(i,s),r=$(l);a.empty().append(r),a.find(".paginate a:not(.disabled,.cur)").click(function(){for(var e=$(this).attr("href"),t=e.split("/"),n=0;n<t.length;n++)if("p"==t[n]){o.data.p=t[n+1].replace(/.html/,""),c();break}return!1}),e&&e(),o.onPageChange&&o.onPageChange(n,t)};$.ajax({url:s+"?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:o.data,success:function(e){1==e.status?l(e):HYD.hint("danger","对不起，获取数据失败："+e.msg)}})};c(function(){$.jBox.show({title:o.title,width:o.width,minHeight:o.minHeight,content:a,btnOK:{show:!1},btnCancel:{show:!1},onOpen:function(e){n=e,o.onOpen&&o.onOpen(e,t)}})})},HYD.regRules={email:/^[a-z]([a-z0-9]*[-_]?[a-z0-9]+)*@([a-z0-9]*[-_]?[a-z0-9]+)+[\.][a-z]{2,3}([\.][a-z]{2})?$/i,mobphone:/^(1(([35][0-9])|(47)|[8][01236789]))\d{8}$/,telphone:/^0\d{2,3}(\-)?\d{7,8}$/,integer:/^\d+$/,"float":/^[\d]*\.?[\d]+$/},HYD.popbox.iconimgsrc={data:{style1:{color0:["/Public/images/icon/style1/color0/icon_home.png","/Public/images/icon/style1/color0/icon_allgoods.png","/Public/images/icon/style1/color0/icon_newgoods.png","/Public/images/icon/style1/color0/icon_user.png","/Public/images/icon/style1/color0/icon_fx.png","/Public/images/icon/style1/color0/icon_active.png","/Public/images/icon/style1/color0/icon_hotsale.png","/Public/images/icon/style1/color0/icon_subject.png","/Public/images/icon/style1/color0/style1_gz0.png","/Public/images/icon/style1/color0/style1_shopcar0.png"],color1:["/Public/images/icon/style1/color1/icon_home.png","/Public/images/icon/style1/color1/icon_allgoods.png","/Public/images/icon/style1/color1/icon_newgoods.png","/Public/images/icon/style1/color1/icon_user.png","/Public/images/icon/style1/color1/icon_fx.png","/Public/images/icon/style1/color1/icon_active.png","/Public/images/icon/style1/color1/icon_hotsale.png","/Public/images/icon/style1/color1/icon_subject.png","/Public/images/icon/style1/color1/style1_gz1.png","/Public/images/icon/style1/color1/style1_shopcar1.png"],color2:["/Public/images/icon/style1/color2/icon_home.png","/Public/images/icon/style1/color2/icon_allgoods.png","/Public/images/icon/style1/color2/icon_newgoods.png","/Public/images/icon/style1/color2/icon_user.png","/Public/images/icon/style1/color2/icon_fx.png","/Public/images/icon/style1/color2/icon_active.png","/Public/images/icon/style1/color2/icon_hotsale.png","/Public/images/icon/style1/color2/icon_subject.png","/Public/images/icon/style1/color2/style1_gz2.png","/Public/images/icon/style1/color2/style1_shopcar2.png"],color3:["/Public/images/icon/style1/color3/icon_home.png","/Public/images/icon/style1/color3/icon_allgoods.png","/Public/images/icon/style1/color3/icon_newgoods.png","/Public/images/icon/style1/color3/icon_user.png","/Public/images/icon/style1/color3/icon_fx.png","/Public/images/icon/style1/color3/icon_active.png","/Public/images/icon/style1/color3/icon_hotsale.png","/Public/images/icon/style1/color3/icon_subject.png","/Public/images/icon/style1/color3/style1_gz3.png","/Public/images/icon/style1/color3/style1_shopcar3.png"],color4:["/Public/images/icon/style1/color4/icon_home.png","/Public/images/icon/style1/color4/icon_allgoods.png","/Public/images/icon/style1/color4/icon_newgoods.png","/Public/images/icon/style1/color4/icon_user.png","/Public/images/icon/style1/color4/icon_fx.png","/Public/images/icon/style1/color4/icon_active.png","/Public/images/icon/style1/color4/icon_hotsale.png","/Public/images/icon/style1/color4/icon_subject.png","/Public/images/icon/style1/color4/style1_gz4.png","/Public/images/icon/style1/color4/style1_shopcar4.png"],color5:["/Public/images/icon/style1/color5/icon_home.png","/Public/images/icon/style1/color5/icon_allgoods.png","/Public/images/icon/style1/color5/icon_newgoods.png","/Public/images/icon/style1/color5/icon_user.png","/Public/images/icon/style1/color5/icon_fx.png","/Public/images/icon/style1/color5/icon_active.png","/Public/images/icon/style1/color5/icon_hotsale.png","/Public/images/icon/style1/color5/icon_subject.png","/Public/images/icon/style1/color5/style1_gz5.png","/Public/images/icon/style1/color5/style1_shopcar5.png"],color6:["/Public/images/icon/style1/color6/icon_home.png","/Public/images/icon/style1/color6/icon_allgoods.png","/Public/images/icon/style1/color6/icon_newgoods.png","/Public/images/icon/style1/color6/icon_user.png","/Public/images/icon/style1/color6/icon_fx.png","/Public/images/icon/style1/color6/icon_active.png","/Public/images/icon/style1/color6/icon_hotsale.png","/Public/images/icon/style1/color6/icon_subject.png","/Public/images/icon/style1/color6/style1_gz6.png","/Public/images/icon/style1/color6/style1_shopcar6.png"],color7:["/Public/images/icon/style1/color7/icon_home.png","/Public/images/icon/style1/color7/icon_allgoods.png","/Public/images/icon/style1/color7/icon_newgoods.png","/Public/images/icon/style1/color7/icon_user.png","/Public/images/icon/style1/color7/icon_fx.png","/Public/images/icon/style1/color7/icon_active.png","/Public/images/icon/style1/color7/icon_hotsale.png","/Public/images/icon/style1/color7/icon_subject.png","/Public/images/icon/style1/color7/style1_gz7.png","/Public/images/icon/style1/color7/style1_shopcar7.png"],color8:["/Public/images/icon/style1/color8/icon_home.png","/Public/images/icon/style1/color8/icon_allgoods.png","/Public/images/icon/style1/color8/icon_newgoods.png","/Public/images/icon/style1/color8/icon_user.png","/Public/images/icon/style1/color8/icon_fx.png","/Public/images/icon/style1/color8/icon_active.png","/Public/images/icon/style1/color8/icon_hotsale.png","/Public/images/icon/style1/color8/icon_subject.png","/Public/images/icon/style1/color8/style1_gz8.png","/Public/images/icon/style1/color8/style1_shopcar8.png"]},style2:{color0:["/Public/images/icon/style2/color0/icon_home.png","/Public/images/icon/style2/color0/icon_allgoods.png","/Public/images/icon/style2/color0/icon_newgoods.png","/Public/images/icon/style2/color0/icon_user.png","/Public/images/icon/style2/color0/icon_fx.png","/Public/images/icon/style2/color0/icon_active.png","/Public/images/icon/style2/color0/icon_hotsale.png","/Public/images/icon/style2/color0/icon_subject.png","/Public/images/icon/style2/color0/style2_gz0.png","/Public/images/icon/style2/color0/style2_shopcar0.png"],color1:["/Public/images/icon/style2/color1/icon_home.png","/Public/images/icon/style2/color1/icon_allgoods.png","/Public/images/icon/style2/color1/icon_newgoods.png","/Public/images/icon/style2/color1/icon_user.png","/Public/images/icon/style2/color1/icon_fx.png","/Public/images/icon/style2/color1/icon_active.png","/Public/images/icon/style2/color1/icon_hotsale.png","/Public/images/icon/style2/color1/icon_subject.png","/Public/images/icon/style2/color1/style2_gz1.png","/Public/images/icon/style2/color1/style2_shopcar1.png"],
color2:["/Public/images/icon/style2/color2/icon_home.png","/Public/images/icon/style2/color2/icon_allgoods.png","/Public/images/icon/style2/color2/icon_newgoods.png","/Public/images/icon/style2/color2/icon_user.png","/Public/images/icon/style2/color2/icon_fx.png","/Public/images/icon/style2/color2/icon_active.png","/Public/images/icon/style2/color2/icon_hotsale.png","/Public/images/icon/style2/color2/icon_subject.png","/Public/images/icon/style2/color2/style2_gz2.png","/Public/images/icon/style2/color2/style2_shopcar2.png"],color3:["/Public/images/icon/style2/color3/icon_home.png","/Public/images/icon/style2/color3/icon_allgoods.png","/Public/images/icon/style2/color3/icon_newgoods.png","/Public/images/icon/style2/color3/icon_user.png","/Public/images/icon/style2/color3/icon_fx.png","/Public/images/icon/style2/color3/icon_active.png","/Public/images/icon/style2/color3/icon_hotsale.png","/Public/images/icon/style2/color3/icon_subject.png","/Public/images/icon/style2/color3/style2_gz3.png","/Public/images/icon/style2/color3/style2_shopcar3.png"],color4:["/Public/images/icon/style2/color4/icon_home.png","/Public/images/icon/style2/color4/icon_allgoods.png","/Public/images/icon/style2/color4/icon_newgoods.png","/Public/images/icon/style2/color4/icon_user.png","/Public/images/icon/style2/color4/icon_fx.png","/Public/images/icon/style2/color4/icon_active.png","/Public/images/icon/style2/color4/icon_hotsale.png","/Public/images/icon/style2/color4/icon_subject.png","/Public/images/icon/style2/color4/style2_gz4.png","/Public/images/icon/style2/color4/style2_shopcar4.png"],color5:["/Public/images/icon/style2/color5/icon_home.png","/Public/images/icon/style2/color5/icon_allgoods.png","/Public/images/icon/style2/color5/icon_newgoods.png","/Public/images/icon/style2/color5/icon_user.png","/Public/images/icon/style2/color5/icon_fx.png","/Public/images/icon/style2/color5/icon_active.png","/Public/images/icon/style2/color5/icon_hotsale.png","/Public/images/icon/style2/color5/icon_subject.png","/Public/images/icon/style2/color5/style2_gz5.png","/Public/images/icon/style2/color5/style2_shopcar5.png"],color6:["/Public/images/icon/style2/color6/icon_home.png","/Public/images/icon/style2/color6/icon_allgoods.png","/Public/images/icon/style2/color6/icon_newgoods.png","/Public/images/icon/style2/color6/icon_user.png","/Public/images/icon/style2/color6/icon_fx.png","/Public/images/icon/style2/color6/icon_active.png","/Public/images/icon/style2/color6/icon_hotsale.png","/Public/images/icon/style2/color6/icon_subject.png","/Public/images/icon/style2/color6/style2_gz6.png","/Public/images/icon/style2/color6/style2_shopcar6.png"],color7:["/Public/images/icon/style2/color7/icon_home.png","/Public/images/icon/style2/color7/icon_allgoods.png","/Public/images/icon/style2/color7/icon_newgoods.png","/Public/images/icon/style2/color7/icon_user.png","/Public/images/icon/style2/color7/icon_fx.png","/Public/images/icon/style2/color7/icon_active.png","/Public/images/icon/style2/color7/icon_hotsale.png","/Public/images/icon/style2/color7/icon_subject.png","/Public/images/icon/style2/color7/style2_gz7.png","/Public/images/icon/style2/color7/style2_shopcar7.png"],color8:["/Public/images/icon/style2/color8/icon_home.png","/Public/images/icon/style2/color8/icon_allgoods.png","/Public/images/icon/style2/color8/icon_newgoods.png","/Public/images/icon/style2/color8/icon_user.png","/Public/images/icon/style2/color8/icon_fx.png","/Public/images/icon/style2/color8/icon_active.png","/Public/images/icon/style2/color8/icon_hotsale.png","/Public/images/icon/style2/color8/icon_subject.png","/Public/images/icon/style2/color8/style2_gz8.png","/Public/images/icon/style2/color8/style2_shopcar8.png"]},style3:{color0:["/Public/images/icon/style3/color0/icon_home.png","/Public/images/icon/style3/color0/icon_allgoods.png","/Public/images/icon/style3/color0/icon_newgoods.png","/Public/images/icon/style3/color0/icon_user.png","/Public/images/icon/style3/color0/icon_fx.png","/Public/images/icon/style3/color0/icon_active.png","/Public/images/icon/style3/color0/icon_hotsale.png","/Public/images/icon/style3/color0/icon_subject.png","/Public/images/icon/style3/color0/style3_gz0.png","/Public/images/icon/style3/color0/style3_shopcar0.png"],color1:["/Public/images/icon/style3/color1/icon_home.png","/Public/images/icon/style3/color1/icon_allgoods.png","/Public/images/icon/style3/color1/icon_newgoods.png","/Public/images/icon/style3/color1/icon_user.png","/Public/images/icon/style3/color1/icon_fx.png","/Public/images/icon/style3/color1/icon_active.png","/Public/images/icon/style3/color1/icon_hotsale.png","/Public/images/icon/style3/color1/icon_subject.png","/Public/images/icon/style3/color1/style3_gz1.png","/Public/images/icon/style3/color1/style3_shopcar1.png"],color2:["/Public/images/icon/style3/color2/icon_home.png","/Public/images/icon/style3/color2/icon_allgoods.png","/Public/images/icon/style3/color2/icon_newgoods.png","/Public/images/icon/style3/color2/icon_user.png","/Public/images/icon/style3/color2/icon_fx.png","/Public/images/icon/style3/color2/icon_active.png","/Public/images/icon/style3/color2/icon_hotsale.png","/Public/images/icon/style3/color2/icon_subject.png","/Public/images/icon/style3/color2/style3_gz2.png","/Public/images/icon/style3/color2/style3_shopcar2.png"],color3:["/Public/images/icon/style3/color3/icon_home.png","/Public/images/icon/style3/color3/icon_allgoods.png","/Public/images/icon/style3/color3/icon_newgoods.png","/Public/images/icon/style3/color3/icon_user.png","/Public/images/icon/style3/color3/icon_fx.png","/Public/images/icon/style3/color3/icon_active.png","/Public/images/icon/style3/color3/icon_hotsale.png","/Public/images/icon/style3/color3/icon_subject.png","/Public/images/icon/style3/color3/style3_gz3.png","/Public/images/icon/style3/color3/style3_shopcar3.png"],color4:["/Public/images/icon/style3/color4/icon_home.png","/Public/images/icon/style3/color4/icon_allgoods.png","/Public/images/icon/style3/color4/icon_newgoods.png","/Public/images/icon/style3/color4/icon_user.png","/Public/images/icon/style3/color4/icon_fx.png","/Public/images/icon/style3/color4/icon_active.png","/Public/images/icon/style3/color4/icon_hotsale.png","/Public/images/icon/style3/color4/icon_subject.png","/Public/images/icon/style3/color4/style3_gz4.png","/Public/images/icon/style3/color4/style3_shopcar4.png"],color5:["/Public/images/icon/style3/color5/icon_home.png","/Public/images/icon/style3/color5/icon_allgoods.png","/Public/images/icon/style3/color5/icon_newgoods.png","/Public/images/icon/style3/color5/icon_user.png","/Public/images/icon/style3/color5/icon_fx.png","/Public/images/icon/style3/color5/icon_active.png","/Public/images/icon/style3/color5/icon_hotsale.png","/Public/images/icon/style3/color5/icon_subject.png","/Public/images/icon/style3/color5/style3_gz5.png","/Public/images/icon/style3/color5/style3_shopcar5.png"],color6:["/Public/images/icon/style3/color6/icon_home.png","/Public/images/icon/style3/color6/icon_allgoods.png","/Public/images/icon/style3/color6/icon_newgoods.png","/Public/images/icon/style3/color6/icon_user.png","/Public/images/icon/style3/color6/icon_fx.png","/Public/images/icon/style3/color6/icon_active.png","/Public/images/icon/style3/color6/icon_hotsale.png","/Public/images/icon/style3/color6/icon_subject.png","/Public/images/icon/style3/color6/style3_gz6.png","/Public/images/icon/style3/color6/style3_shopcar6.png"],color7:["/Public/images/icon/style3/color7/icon_home.png","/Public/images/icon/style3/color7/icon_allgoods.png","/Public/images/icon/style3/color7/icon_newgoods.png","/Public/images/icon/style3/color7/icon_user.png","/Public/images/icon/style3/color7/icon_fx.png","/Public/images/icon/style3/color7/icon_active.png","/Public/images/icon/style3/color7/icon_hotsale.png","/Public/images/icon/style3/color7/icon_subject.png","/Public/images/icon/style3/color7/style3_gz7.png","/Public/images/icon/style3/color7/style3_shopcar7.png"],color8:["/Public/images/icon/style3/color8/icon_home.png","/Public/images/icon/style3/color8/icon_allgoods.png","/Public/images/icon/style3/color8/icon_newgoods.png","/Public/images/icon/style3/color8/icon_user.png","/Public/images/icon/style3/color8/icon_fx.png","/Public/images/icon/style3/color8/icon_active.png","/Public/images/icon/style3/color8/icon_hotsale.png","/Public/images/icon/style3/color8/icon_subject.png","/Public/images/icon/style3/color8/style3_gz8.png","/Public/images/icon/style3/color8/style3_shopcar8.png"]}}},HYD.urgencyPopup=function(){var e=$.cookie("urgencyPopup"),t=(new Date).getTime(),n=36e5;if(e||(e=0),console.log(e,n,t),0==e||parseInt(e)+n<t){$.cookie("urgencyPopup",t,{expires:30,path:"/"});var i=function(e){$.jBox.show({title:"提示",content:"<p style='font-size:14px;'>"+e+"</p>",btnOK:{onBtnClick:function(e){$.jBox.close(e)}},btnCancel:{show:!1}})};$("#urgency-content").jBox({title:"紧急通知",onOpen:function(e){e.addClass("jbox-urgencyPopup"),$chk=e.find(".j-urgency-checkbox"),$btn=e.find(".j-urgency-submit"),$btn.click(function(){$chk.is(":checked")?$.ajax({url:"/Shop/apply_temporary_domain",type:"get",dataType:"json",beforeSend:function(){$.jBox.showloading()},success:function(t){$.jBox.hideloading(),1==t.status?($.jBox.close(e),HYD.hint("success","恭喜您，临时域名申请成功！")):HYD.hint("danger","对不起，"+t.msg)}}):i("请先注册域名并提交备案信息!")})},btnOK:{show:!1},btnCancel:{show:!1}})}},$(function(){top.location!=self.location&&(top.location.href=self.location.href),$(".header-ctrl-item").hover(function(){var e=$(this);e.data("type"),e.data("cache");e.find(".header-ctrl-item-children").length&&e.addClass("show")},function(){$(this).removeClass("show")}),$(".tips").tooltips();var e=$(".container .inner");if(e.length){var t=function(){HYD.Constant.windowHeight=$(this).height(),HYD.Constant.windowWidth=$(this).width(),HYD.Constant.containerOffset=e.offset(),HYD.Constant.containerWidth=e.outerWidth()},n=function(){$("#j-gotop").css("left",HYD.Constant.containerWidth+HYD.Constant.containerOffset.left+10)};$(window).resize(function(){t(),n()}),t(),n()}$.ajaxSetup({timeout:3e5,error:function(e,t,n){"timeout"==t&&(HYD&&HYD.hint?HYD.hint("warning","请求超时，请重试！"):alert("请求超时，请重试！"),$.jBox.hideloading())}}),function(){var e=function(){$.jBox.show({title:"温馨提示",width:520,content:$("#tpl_jbox_domain_tip").html(),btnOK:{show:!1},btnCancel:{show:!1},onOpen:function(){},onClosed:function(){}})};window.is_domain_tip&&e()}(),$(".js-save-btn").click(function(){HYD.hint("success","恭喜，保存成功！")}),$(".content-left .left-menu dt").toggle(function(){$(this).siblings("dd").hide()},function(){$(this).siblings("dd").show()}),$(".member_down_box .user_privs_link").mouseenter(function(){$(this).prev().find("a").css("border-bottom-color","#fff")}).mouseleave(function(){$(this).prev().find("a").css("border-bottom-color","#f2f2f2")}),function(){var e=$(".content-left");$("#j-btn-leftMenuFold").click(function(){e.is(":visible")?(e.hide(),$(this).addClass("hideStatus")):(e.show(),$(this).removeClass("hideStatus"))})}(),$(".sec .left-menu dt").mouseenter(function(){$(this).parents(".sec").find("dt").removeClass("active"),$(this).addClass("active");var e=$(this).parents("dl").data("title");$(".third ul").each(function(){$(this).data("parent")==e&&$(this).show().siblings().hide()})});var i=$("body").height()-$(".header").outerHeight()-10-28-10;$(".bg_corl").css("top",i),$(".content-left").width()<250&&$(".bg_corl").css({left:"124px",padding:0});var o,a,c,s;$(document).on("click",".j-toggle-hide",function(){if(o=$("#content-left").outerWidth(),$("#content-left").css("width",$(".sec").outerWidth()),$(".third").addClass("enter").hide(),$(".third .bg_corl").removeClass("j-toggle-hide").addClass("j-toggle-show"),$(".third .bg_corl").find("img").attr({src:"/Public/images/simgle_left_third.png"}),$(".third .bg_corl").find("p").text("固定"),a=$(".bg_corl").css("left"),c=$(".bg_corl").css("top"),$(".bg_corl").css({left:(parseInt($(".bg_corl").css("left"))-$(".third_box").outerWidth()-12)/2,top:parseInt($(".bg_corl").css("top"))-1}),$("#content-left").css("border-right","none"),$("#content-left").hasClass("fix")){$("#content-right-box").css("margin-left",$("#content-left").width()+10);var e=$(".third").prop("outerHTML");0==$("#content-right-box .third").length&&($("#content-right-box").prepend(e),$("#content-right-box .third").addClass("clone"))}s=$("#content-right-box").css("margin-left"),0==$("#content-left.fix").length&&$("#content-right-box").css("margin-left",""),sessionStorage.setItem("show_third_menu","0")}),$(document).on("click",".j-toggle-show",function(){var e=$(window).scrollTop()>=74&&0==$(window).scrollLeft();if(e)var t=c+$(".header").outerHeight();else var t=$("body").height()-$(".header").outerHeight()-10-28-10+$(window).scrollTop();$("#content-left").css({width:o,"border-right":"1px solid #e4e4e4"}),$(".third").removeClass("enter"),$(".third .bg_corl").addClass("j-toggle-hide").removeClass("j-toggle-show"),$(".third .bg_corl").find("img").attr({src:"/Public/images/simgle_right_third.png"}),$(".third .bg_corl").find("p").text("收起"),$(".bg_corl").css({left:a,top:t}),$(".third.clone").remove(),$("#content-right-box").css("margin-left",$("#content-left").width()+10),$(".third").show(),sessionStorage.setItem("show_third_menu","1")}),$(window).scroll(function(){var e=$(this).scrollTop(),t=$("body").height();e>=150?$("#j-gotop").fadeIn(300):$("#j-gotop").fadeOut(300);var n=e>=71;if(e>=71)$("#content-left .sec").css("height",t),$("#content-left-box").css("height",t);else{var i=t+e-71;$("#content-left .sec").css("height",i),$("#content-left-box").css("height",i)}if(n){$("#content-left").addClass("fix");var o=parseFloat($("#content-left").width())+10;$("#content-right-box").css("margin-left",o+"px");var a=$("body").height()-28-10;if($(".bg_corl").css("top",a),1!=$(".bg_corl.j-toggle-hide").length){$(".third").eq(0).hide(),$("#content-right-box").css("margin-left",$(".sec").width()+10);var c=$(".third").prop("outerHTML");0==$("#content-right-box .third").length&&($("#content-right-box").prepend(c),$("#content-right-box .third").addClass("clone")),$(".third.clone").addClass("enter"),0==$(".j-toggle-show").length&&$(".third").eq(0).hasClass("enter")&&$(".third.clone").show()}$(".cb-contain").each(function(){var e=$(this).width();$(this).find(".j-chartPanel").css("width",e+"px")})}else{$("#content-left").removeClass("fix"),$("#content-right-box").css("margin-left","0");var a=$("body").height()-$(".header").outerHeight()-10-28-10+$(window).scrollTop();$(".bg_corl").css("top",a),$(".third.clone").remove(),0==$(".j-toggle-show").length&&$(".third").eq(0).show(),$(".cb-contain").each(function(){var e=$(this).width();$(this).find(".j-chartPanel").css("width",e+"px")})}if($("#chart_ddtjpei").length>0)var s=$("#chart_ddtjpei").highcharts();if($("#chart_ddje").length>0)var l=$("#chart_ddje").highcharts();if($("#chart_fxddzs").length>0)var r=$("#chart_fxddzs").highcharts();if($("#chart_ddzs").length>0)var d=$("#chart_ddzs").highcharts();if($("#chart_mmpv").length>0)var g=$("#chart_mmpv").highcharts();$("#chart_ddtjpei").length>0&&void 0!=s&&s.reflow(),$("#chart_ddje").length>0&&void 0!=l&&l.reflow(),$("#chart_fxddzs").length>0&&void 0!=r&&r.reflow(),$("#chart_ddzs").length>0&&void 0!=d&&d.reflow(),$("#chart_mmpv").length>0&&void 0!=g&&g.reflow()}),$(document).on("mouseenter",".left-menu",function(){$(".third").css("display","block");var e=$(".content-left .third").outerWidth()/2-$(".j-toggle-show").outerWidth()/2;$(".j-toggle-show").css("left",e)}),$(document).on("mouseleave","#content-right-box .third, .content-left .third",function(){if($(".third").hasClass("enter")){$(".third").css("display","none");var e=$(".content-left .third").outerWidth()/2-$(".j-toggle-show").outerWidth()/2;$(".j-toggle-show").css("left",e)}}),$(function(){if(0==sessionStorage.getItem("show_third_menu")){if(o=$("#content-left").outerWidth(),$("#content-left").css("width",$(".sec").outerWidth()),$(".third").addClass("enter").hide(),$(".third .bg_corl").removeClass("j-toggle-hide").addClass("j-toggle-show"),$(".third .bg_corl").find("img").attr({src:"/Public/images/simgle_left_third.png"}),$(".third .bg_corl").find("p").text("固定"),a=$(".bg_corl").css("left"),c=$(".bg_corl").css("top"),$(".bg_corl").css({left:(parseInt($(".bg_corl").css("left"))-$(".third_box").outerWidth()-12)/2,top:parseInt($(".bg_corl").css("top"))-1}),$("#content-left").css("border-right","none"),$("#content-left").hasClass("fix")){console.log($("#content-left").width()),$("#content-right-box").css("margin-left",$("#content-left").width()+10);var e=$(".third").prop("outerHTML");0==$("#content-right-box .third").length&&($("#content-right-box").prepend(e),$("#content-right-box .third").addClass("clone"))}s=$("#content-right-box").css("margin-left"),0==$("#content-left.fix").length&&$("#content-right-box").css("margin-left","")}}),$(function(){var e=$(".j-default-set"),t="";e.on("click",function(){var n=$(this).parents(".form-controls").find("input");n.val(t),n.change(),$(this).siblings("li").text("+"),e.hide()})}),$(".po_list .cursor_pointer").on("click",function(){var e=$(this),t=e.find(".up").attr("href"),n=e.find(".down").attr("href");e.find(".up").hasClass("act")?window.location.href=n:window.location.href=t}),$(".sysPanel .toggle_btn").on("click",function(){var e=$(this),t=e.parents(".sysPanel");e.hasClass("show")?(e.removeClass("show"),e.find("em").text("展开"),t.find(".hide_option").slideUp(300)):(e.addClass("show"),e.find("em").text("收起"),t.find(".hide_option").slideDown(300))})}),$(function(){var e=$(".wxtables").find("input[type='checkbox'].table-ckbs");$(".btn_table_selectAll").click(function(){e.attr("checked",!0)}),$(".btn_table_Cancle").click(function(){e.attr("checked",!1)}),$(".paginate").each(function(){var e=$(this),t=e.find("input"),n=e.find(".goto"),i=window.location.href.toString();i=i.replace(/.html/g,""),t.focus(function(){$(this).addClass("focus").siblings(".goto").addClass("focus")}),t.blur(function(){""==$(this).val()&&$(this).removeClass("focus").siblings(".goto").removeClass("focus")}),t.keypress(function(e){var t=window.event?e.keyCode:e.which;return 13==t&&(window.location.href=$(this).siblings("a.goto").attr("href")),8==t||46==t||37==t||39==t||!(t<48||t>57)}),t.keyup(function(e){var t=$(this).val(),o=i.split("/"),a=o.length,c=!1,s=!1;""==o[a-1]&&(o.pop(),a=o.length,c=!0),(c||"p"!=o[a-2])&&(o.push("p"),a=o.length,s=!0),c||s?o[a]=t+".html":o[a-1]=t+".html",n.attr("href",o.join("/"))})})}),$(function(){$(document).on("click",".tabs .tabs_a",function(){var e=$(this),t=e.data("origin"),n=0;e.parent().hasClass("wizardstep")||e.parent().hasClass("nochange")||(e.addClass("active").siblings(".tabs_a").removeClass("active"),e.data("index")?(n=e.data("index"),$(".tabs-content[data-origin='"+t+"']").find(".tc[data-index='"+n+"']").removeClass("hide").siblings(".tc").addClass("hide")):(n=e.index(),$(".tabs-content[data-origin='"+t+"']").find(".tc:eq("+n+")").removeClass("hide").siblings(".tc").addClass("hide")))})}),$(function(){$(".alert.disable-del").each(function(){var e=$('<a href="javascript:;" class="alert-delete" title="隐藏"><i class="gicon-remove"></i></a>');e.click(function(){$(this).parent(".alert").fadeOut()}),$(this).append(e)}),_QV_="%E6%9D%AD%E5%B7%9E%E5%90%AF%E5%8D%9A%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E7%89%88%E6%9D%83%E6%89%80%E6%9C%89"}),function(e,t,n){var i={trigger:"hover"};e.fn.tooltips=function(t){return this.each(function(){var n=function(){var n=e(this),i=n.data("content"),o=n.offset(),a={width:n.outerWidth(!0),height:n.outerHeight(!0)},c=n.data("placement");if(this.tip=null,i=void 0==i||""==i?i=n.text():i,null==this.$tip){var s=e("#tpl_tooltips").html();if(void 0==s||""==s)return void console.log("Please check template!");var l=_.template(s,{content:i,placement:c});if(this.$tip=e(l),t){var r=n.offset().top-t.offset().top,d=n.offset().left-t.offset().left;o={top:r,left:d};var g=t.width(),u=g-80;this.$tip.css("max-width",u),t.append(this.$tip)}else e("body").append(this.$tip);var p=0,h=0,f=this.$tip.outerWidth(!0),m=this.$tip.outerHeight(!0);switch(c){case"top":p=o.top+a.height+5,h=o.left-5;break;case"bottom":p=o.top-m-5,h=o.left-5;break;case"left":p=o.top-a.height/2,h=o.left+a.width+5;break;case"right":p=o.top+a.height/2-m/2,h=o.left-f-5;break;case"left_center":p=360,h=o.left-f+50}this.$tip.css({top:p,left:h})}this.$tip.stop(!0,!0).fadeIn(300)},o=function(){this.$tip&&this.$tip.stop(!0,!0).fadeOut(300)},a=e(this).data("trigger");switch(a=void 0!=a&&""!=a?a:i.trigger){case"hover":e(this).hover(n,o);break;case"click":e(this).click(n).mouseleave(o)}})}}(jQuery,document,window),$(function(){$(document).on("mouseover",".droplist .j-droplist-toggle",function(){$(this).siblings(".droplist-menu").show()}),$(document).on("mouseleave",".droplist .droplist-menu",function(){$(this).hide()}),$(document).on("mouseleave",".droplist",function(){$(this).find(".droplist-menu").hide()}),$(document).on("click",".droplist .droplist-menu a",function(){$(this).parents(".droplist-menu").hide()})}),function(e,t,n){var i={callback:null},o={},a={width:e(n).width(),height:e(n).height()},c={main:e("#tpl_albums_main").html(),overlay:e("#tpl_albums_overlay").html(),tree:e("#tpl_albums_tree").html(),treeFn:e("#tpl_albums_tree_fn").html(),imgs:e("#tpl_albums_imgs").html()},s={folderID:"",moveFolderID:0,imgs:{}},l={getFolderTree:"/Design/getFolderTree",getSubFolderTree:"/Design/getSubFolderTree",getImgList:"/Design/getImgList",addImg:"/Design/uploadFile/sid/"+e.cookie("shop_id"),moveImg:"/Design/moveImg",delImg:"/Design/delImg",addFolder:"/Design/addFolder",renameFolder:"/Design/renameFolder",delFolder:"/Design/delFolder",moveCateImg:"/Design/moveCateImg",renameImg:"/Design/renameImg"},r=function(t,n,i,o,a){var r=arguments.callee,d=t.find("#j-panelImgs"),g=t.find("#j-panelPaginate"),u=n>=0?{id:n,p:i,file_name:o}:{p:i,file_name:o};"undefined"==typeof GLOBAL_NEED_COMPRESS||0==GLOBAL_NEED_COMPRESS?u.need_compress=0:u.need_compress=1,e.ajax({url:l.getImgList+"?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:u,beforeSend:function(){d.find(".j-loading").show()},success:function(i){if(1==i.status){s.imgs=_.isArray(i.data)?i.data:null;var u=e(_.template(c.imgs,{dataset:s.imgs})),p=e(i.page);if(d.find(".j-loading").hide().end().find("ul,.j-noPic").remove().end().append(u),g.empty().append(p),p.filter("a:not(.disabled,.cur)").click(function(){var i=e(this).attr("href"),a=i.split("/");return a=a[a.length-1],a=a.replace(/.html/,""),r(t,n,a,o),!1}),a){var h=e(".j-albumsNodes"),f=[],m=0,b=function(t){e.ajax({url:"/Design/getImgCategory",type:"post",dataType:"json",data:{id:t},success:function(e){if(1==e.status){f=[];var t=e.imgCate;for(var n in t)f.push(t[n].category_img_id);m=0,y(f[m])}}})};e("#j-panelImgs").off("click","li").on("click","li",function(){var t=e(this),n=t.data("id");t.hasClass("selected")?$():b(n)});var v=function(t,n){e.ajax({url:l.getSubFolderTree+"?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{id:n},success:function(n){if(1==n.status){var i=_.template(c.treeFn),o=i({dataset:n.data,templateFn:i});$render=e(o),t.parent("dt").siblings("dd").empty().append($render),$render.filter("dl").slideDown(200),y(f[m])}}})},y=function(t){h.find("dt").each(function(){var n=e(this),i=n.data("id"),o=f.length;i==t&&(m++,n.find(".icon-folder").addClass("open"),o==m&&n.find(".j-name").addClass("highlight"),v(n.find(".icon-folder"),i))})},$=function(){h.find("dt").each(function(){var t=e(this),n=t.data("id");f.length;if(t.find(".icon-folder").hasClass("open")){if(t.find(".icon-folder").removeClass("open"),n==-1)return;t.siblings("dd").children().css("display","none")}t.find(".j-name").hasClass("highlight")&&t.find(".j-name").removeClass("highlight")})}}}else HYD.hint("danger","对不起，图片获取失败："+i.msg)}})};UpdateSubTreeNums=function(n){if("undefined"==typeof n)var n=e(t).find(".j-albumsNodes .selected").data("id");e.ajax({url:"/Design/getAllSubFolderTree?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{id:n},success:function(n){if(1==n.status){var i=n.data.tree,o=e(t).find("#j-panelTree");i.push({id:"-1",picNum:n.data.total},{id:"0",picNum:n.data.nocat_total});var a=function(e){var t=arguments.callee;_.each(e,function(e){o.find("dt[data-id="+e.id+"]").find(".j-num").text(e.picNum),e.subFolder&&e.subFolder.length&&t(e.subFolder)})};a(i)}else console.log("更新文件夹树图片数量失败")}})},e.albums=function(n){o=e.extend(!0,{},i,n);var d=e("#albums"),g=e("#albums-overlay");if(!d.length){d=e(c.main),g=e(c.overlay),e("body").append(d.hide(),g.hide());var u=d.find("#j-close"),p=d.find("#j-addFolder"),h=d.find("#j-renameFolder"),f=d.find("#j-delFolder"),m=d.find("#j-addImg"),b=d.find("#j-moveImg"),v=d.find("#j-cateImg"),y=d.find("#j-delImg"),$=d.find("#j-panelTree"),P=function(){d.fadeOut("fast"),g.fadeOut("fast"),d.find("#j-panelImgs li").removeClass("selected")};e.ajax({url:l.getFolderTree+"?v="+Math.round(100*Math.random()),type:"post",dataType:"json",success:function(t){if(1==t.status){var n=_.template(c.treeFn),i=n({dataset:t.data.tree,templateFn:n}),o=e(_.template(c.tree,{dataset:t.data,nodes:i}));$.empty().append(o),d.find(".j-albumsNodes > dt:first").click()}else HYD.hint("danger","对不起，文件夹获取失败："+t.msg)}}),e(t).on("click",".j-albumsNodes dt",function(t){var n=e(this),i=n.data("id");if(n.parents(".j-albumsNodes").find("dt").removeClass("selected"),n.addClass("selected"),e(t.currentTarget).parents(".j-propagation").length)s.moveFolderID=i;else{if(s.folderID==i)return;s.folderID=i;var o=n.data("add"),a=n.data("rename"),c=n.data("del");1==o?p.show():p.hide(),1==a?h.show():h.hide(),1==c?f.show():f.hide(),r(d,s.folderID,1)}return!1});var j=function(t,n){e.ajax({url:l.getSubFolderTree+"?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{id:n},success:function(n){if(1==n.status){var i=_.template(c.treeFn),o=i({dataset:n.data,templateFn:i});$render=e(o),t.parent("dt").siblings("dd").empty().append($render),$render.filter("dl").slideDown(200)}}})};e(t).on("click",".j-albumsNodes dt i",function(){var t=e(this),n=t.parent("dt").siblings("dd").find(" > dl"),i=n.length,o=t.parent("dt").data("id");return t.hasClass("open")?(t.removeClass("open"),n.slideUp(200)):(t.addClass("open"),i?n.slideDown(200):j(t,o)),!1});var x=0;d.on("click","#j-panelImgs li",function(){return e(this).toggleClass("selected"),e(this).find(".img-name-edit").hide(),e(this).data("selectindex",x++),!1}),d.on("click","#j-panelImgs li .albums-edit",function(){return e(this).children(".img-name-edit").show(),!1}),d.on("click","#j-useImg",function(){if(!d.find("#j-panelImgs li.selected").length)return void HYD.hint("warning","请选择图片！");var t={},n=[];d.find("#j-panelImgs li.selected").each(function(){t[e(this).data("selectindex")]=s.imgs[e(this).index()].file});for(var i in t)n.push(t[i]);return o.callback&&(o.callback(n),P()),!1}),p.click(function(){var t=[{id:0,name:"未命名文件夹",picNum:0}];e.ajax({url:l.addFolder+"?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{name:t.name,parent_id:s.folderID},success:function(n){if(1==n.status){t[0].id=n.data;var i=_.template(c.treeFn,{dataset:t});$render=e(i),$.find("dt[data-id='"+s.folderID+"']").siblings("dd").append($render),$render.css("display","block"),$render.parent().siblings("dt").find(".icon-folder").addClass("open"),$render.find("dt:first").click(),h.click()}else HYD.hint("danger","对不起，添加失败："+n.msg)}})}),h.click(function(){var t=$.find("dt[data-id='"+s.folderID+"']"),n=t.find(".j-treeShowTxt"),i=t.find(".j-ip"),o=t.find(".j-loading");n.hide(),i.show().focus().select(),i.blur(function(){var t=e(this).val();e.ajax({url:l.renameFolder+"?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{name:t,category_img_id:s.folderID},beforeSend:function(){o.css("display","inline-block")},success:function(e){1==e.status?n.find(".j-name").text(t):HYD.hint("danger","对不起，重命名失败："+e.msg),n.show(),i.hide(),o.hide()}})})}),f.click(function(){var t=e("#tpl_albums_delFolder").html(),n=e(t),i=n.find("input[name=isDelImgs]");e.jBox.show({title:"提示",content:n,btnOK:{onBtnClick:function(t){var n=i.filter(":checked").val();e.ajax({url:l.delFolder+"?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{type:n,id:s.folderID},success:function(e){if(1==e.status){UpdateSubTreeNums();var t=$.find("dt[data-id="+s.folderID+"]").parent("dl");t.parent("dd").siblings("dt").click(),t.remove()}else HYD.hint("danger","对不起，删除失败失败："+e.msg)}}),e.jBox.close(t)}}})}),y.click(function(){if(!d.find("#j-panelImgs li.selected").length)return void HYD.hint("warning","请选择要删除的图片！");var t=[];d.find("#j-panelImgs li.selected").each(function(){t.push(e(this).data("id"))}),e.ajax({url:l.delImg+"?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{file_id:t},success:function(t){1==t.status?(d.find("#j-panelImgs li.selected").fadeOut(300,function(){e(this).remove()}),r(d,s.folderID,1),UpdateSubTreeNums()):HYD.hint("danger","对不起，删除失败："+t.msg)}})}),function(){var t=navigator.userAgent.toLowerCase(),n="ipad"==t.match(/ipad/i),i="iphone os"==t.match(/iphone os/i),o="midp"==t.match(/midp/i),a="rv:1.2.3.4"==t.match(/rv:1.2.3.4/i),c="ucweb"==t.match(/ucweb/i),g="android"==t.match(/android/i),u="windows ce"==t.match(/windows ce/i),p="windows mobile"==t.match(/windows mobile/i);if(n||i||o||a||c||g||u||p)e("#j-addImg").parent("#addImg_load").addClass("btn btn-success").children(".addImg_load_text").text("上传图片"),e("#j-addImg").change(function(){var t=e(this),n=t.get(0).files[0],i=((new Date).getTime(),5242880);if(n.size>i)return void alert("上传的图片不得大于3MB");var o=new XMLHttpRequest,a=new FormData;o.open("POST",l.addImg,!0),e.jBox.showloading("正在上传..."),o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){var t=e.parseJSON(o.responseText);1==t.status?(r(d,s.folderID,1),UpdateSubTreeNums()):HYD.hint(t.msg),e.jBox.hideloading()}},a.append("Filedata",n),o.send(a)});else{m.uploadifive({auto:!0,width:86,height:28,multi:!0,uploadScript:l.addImg,buttonText:"上传图片",fileSizeLimit:"3MB",fileType:"image/jpg,image/jpeg,image/png,image/gif,image/bmp",onAddQueueItem:function(){m.data("uploadifive").settings.formData={cate_id:s.folderID==-1?0:s.folderID,PHPSESSID:e.cookie("PHPSESSID")}},onFallback:function(){HYD.hint("danger","请使用支持html5上传的浏览器")},onUploadComplete:function(e,t){console.log(e,t)},onQueueComplete:function(e){r(d,s.folderID,1),UpdateSubTreeNums()},onError:function(e){"FILE_SIZE_LIMIT_EXCEEDED"==e?e="文件大小超出3MB":"FORBIDDEN_FILE_TYPE"==e?e="文件类型不正确":"404_FILE_NOT_FOUND"==e&&(e="404文件没找到"),HYD.hint("danger","对不起："+file.name+"上传失败："+e)}})}}(),b.click(function(){if(!d.find("#j-panelImgs li.selected").length)return void HYD.hint("warning","请选择要移动的图片！");var t=e("<div class='albums-cl-tree j-albumsNodes j-propagation'></div>");t.append($.find("dd:first").contents().clone()),e.jBox.show({title:"请选择移动文件夹",content:t,onOpen:function(){t.find("dt:first").click()},btnOK:{onBtnClick:function(t){var n=[];d.find("#j-panelImgs li.selected").each(function(){n.push(e(this).data("id"))}),e.ajax({url:l.moveImg+"?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{file_id:n,cate_id:s.moveFolderID},success:function(n){if(1==n.status){var i=e(t).find(".j-albumsNodes .selected").data("id");d.find("#j-panelImgs li.selected").fadeOut(300,function(){e(this).remove()}),UpdateSubTreeNums(),UpdateSubTreeNums(i),HYD.hint("success","恭喜您，操作成功！")}else HYD.hint("danger","对不起，移动失败："+n.msg)}}),e.jBox.close(t)}}})}),v.click(function(){if(!s.folderID)return void HYD.hint("warning","请选择要移动的分类！");var t=e("<div class='albums-cl-tree j-albumsNodes j-propagation'></div>");t.append($.find("dd:first").contents().clone()),e.jBox.show({title:"请选择移动文件夹",content:t,onOpen:function(){t.find("dt:first").click()},btnOK:{onBtnClick:function(t){e.ajax({url:l.moveCateImg+"?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{cid:s.folderID,cate_id:s.moveFolderID},success:function(n){if(1==n.status){var i=e(t).find(".j-albumsNodes .selected").data("id");d.find("#j-panelImgs li.selected").fadeOut(300,function(){
e(this).remove()}),UpdateSubTreeNums(),UpdateSubTreeNums(i),HYD.hint("success","恭喜您，操作成功！")}else HYD.hint("danger","对不起，移动失败："+n.msg)}}),e.jBox.close(t)}}})}),u.click(P)}d.appendTo("body").fadeIn("fast"),g.appendTo("body").fadeIn("fast"),d.outerHeight()>=a.height&&d.css({position:"absolute",marginTop:"0",top:e(t).scrollTop()+10}),d.on("click",".renameImg",function(){var t=e(this),n=t.closest("li").data("id"),i=t.siblings("input.file_name").val();return e.ajax({url:l.renameImg+"?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{file_id:n,file_name:i},success:function(e){1==e.status?(t.closest(".albums-edit").children(".img-name-edit").hide(),t.closest(".albums-edit").children("p").html(i),t.closest(".albums-edit").children("input.file_name").val(i),HYD.hint("success","恭喜您，操作成功！")):HYD.hint("danger","对不起，操作失败")}}),!1}),d.on("click",".searchImg",function(){var t=e(this).prev().val();r(d,s.folderID,1,t,!0)})}}(jQuery,document,window),_QV_="%E6%9D%AD%E5%B7%9E%E5%90%AF%E5%8D%9A%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E7%89%88%E6%9D%83%E6%89%80%E6%9C%89",HYD.popbox.ImgPicker=function(e){$.albums({callback:e})},$(function(){var e='<span class="autosave-loading"></span>',t='<span class="save-success"><em class="gicon-ok white"></em>已自动保存</span>',n="undefined"!=typeof URL_virChkb&&URL_virChkb.length?URL_virChkb:window.location.href;$(".j-vir-chkb").each(function(){var e=$(this),t=e.find(".vir-chkb-actions"),i=e.find(".vir-chkb-enable"),o=e.find(".vir-chkb-disable"),a=e.find(".j-vir-checkbox"),c=!!a.is(":checked");e.find(".j-change-checkbox").length&&(c=!!e.find(".j-change-checkbox").is(":checked")),c?(t.removeClass("disable").addClass("enable"),i.show(),o.hide()):(t.removeClass("enable").addClass("disable"),i.hide(),o.show()),a.change(function(){if(!a.parents(".sysPanel").hasClass("sysPanel-con1")){var e,t=$(this),i=t.attr("name"),o={};e="undefined"==typeof t.data("enableval")?t.is(":checked")?1:0:t.is(":checked")?t.data("enableval"):t.data("disableval"),o.name=i,o.value=e;var c=t.siblings(".j-vir-formdata");c.each(function(){var e=$(this);o[e.data("name")]=e.val()}),$.ajax({url:n+"?v="+Math.round(100*Math.random()),type:"POST",dataType:"json",data:o,success:function(e){1!=e.status&&(HYD.hint("danger","对不起，保存失败："+e.msg),setTimeout(function(){window.location.reload()},1e3))}})}}),t.show().click(function(){var e=$("input[name='allow_store_set_stock']").is(":checked"),n=$("input[name='use_store_stock']").is(":checked"),s=$("input[name='is_store_buy_stock']").is(":checked");if(1==t.data("value")&&s&&n)return HYD.hint("danger",'对不起，保存失败：请先关闭"允许门店购买库存"'),!1;if(2==t.data("value")&&s&&!e)return HYD.hint("danger",'对不起，保存失败：请先关闭"允许门店购买库存"'),!1;if(3==t.data("value")&&(e||!n))return e||n?(HYD.hint("danger",'对不起，保存失败：请先关闭"是否允许门店设置库存"'),!1):(HYD.hint("danger",'对不起，保存失败：请开启"是否使用门店的库存"'),!1);var l=$("input[name='is_dhs_allow_deposit']").is(":checked"),r=$("input[name='allow_tiered_pricing_dhs']").is(":checked"),d=$("input[name='is_dhs_virual_stock']").is(":checked"),g=$("input[name='is_sale_record']").is(":checked"),u=$("input[name='is_sale_record_new']").is(":checked");if(c)o.show(),t.animate({left:-66},150,function(){i.hide()}),a.attr("checked",!1),c=!1,a.trigger("change");else{if("is_dhs_allow_deposit"==t.data("value")&&(r||d))return HYD.hint("danger",'对不起，保存失败：请先关闭"订货商阶梯价"和"是否允许订货商购买虚拟库存"'),!1;if("allow_tiered_pricing_dhs"==t.data("value")){if(l)return HYD.hint("danger",'对不起，保存失败：请先关闭"是否启用预存款"'),!1;if(1==t.data("dhs_salesaward_by_realpay"))return HYD.hint("danger",'对不起，保存失败：请先关闭"销售奖是否按照顶级订货价来计算"'),!1}if("dhs_salesaward_by_realpay"==t.data("value")&&1==t.data("allow_tiered_pricing_dhs"))return HYD.hint("danger",'对不起，保存失败：请先关闭"订货商阶梯价"'),!1;if("is_dhs_virual_stock"==t.data("value")&&l)return HYD.hint("danger",'对不起，保存失败：请先关闭"是否启用预存款"'),!1;if("is_sale_record"==t.data("value")&&u)return HYD.hint("danger",'对不起，保存失败：请先关闭"最近访客和购买记录"'),!1;if("is_sale_record_new"==t.data("value")&&g)return HYD.hint("danger",'对不起，保存失败：请先关闭"销售记录"'),!1;if("dhs_salesaward_by_realpay"==t.data("value")&&g)return HYD.hint("danger",'对不起，保存失败：请先关闭"销售记录"'),!1;$(this).hasClass("business_model_third_actions")?$.jBox.show({title:"开启三级分销",content:"三级分销在微信环境中有潜在风险，是否确认开启？",btnCancel:{onBtnClick:function(e){return $.jBox.close(e),!1}},btnOK:{onBtnClick:function(e){return $.jBox.close(e),i.show(),t.animate({left:0},150,function(){o.hide()}),a.attr("checked",!0),c=!0,a.trigger("change"),!1}}}):(i.show(),t.animate({left:0},150,function(){o.hide()}),a.attr("checked",!0),c=!0,a.trigger("change"))}})}),$(".j-date-autosave").click(function(){WdatePicker({el:this,lang:"auto",dateFmt:"yyyy-MM-dd",minDate:"",maxDate:"",readOnly:!0,isShowClear:!1,isShowOK:!0,isShowToday:!0,autoPickDate:!0,onpicked:function(){var i=$(this),o=i.attr("name"),a=i.val();if(a.length){var c=$(e),s=i.get(0).nextSibling,l=s?$(s):i;$.ajax({url:n+"?v="+Math.round(100*Math.random()),type:"POST",dataType:"json",data:{name:o,value:a},beforeSend:function(){c.insertAfter(l)},success:function(e){c.fadeOut("fast",function(){if($(this).remove(),1==e.status){var n=$(t);n.insertAfter(l).animate({opacity:1},200,function(){setTimeout(function(){n.fadeOut("fast",function(){n.remove()})},1e3)})}else HYD.hint("danger","对不起，保存失败："+e.msg);"dhs_degrade_check_days"==o&&setTimeout(function(){window.location.reload()},500)})}})}}})}),$(document).on("change",".j-text-autosave,.j-select-autosave",function(){var i=$(this),o=i.attr("name"),a=i.val(),c=$(e),s=i.get(0).nextSibling,l=s?$(s):i;$.ajax({url:n+"?v="+Math.round(100*Math.random()),type:"POST",dataType:"json",data:{name:o,value:a},beforeSend:function(){c.insertAfter(l)},success:function(e){c.fadeOut("fast",function(){if($(this).remove(),1==e.status){var n=$(t);n.insertAfter(l).animate({opacity:1},200,function(){setTimeout(function(){n.fadeOut("fast",function(){n.remove()})},1e3)})}else HYD.hint("danger","对不起，保存失败："+e.msg);"dhs_degrade_check_days"==o&&setTimeout(function(){window.location.reload()},500)})}})}),$(".j-radio-autosave").change(function(){var i=$(this),o=i.parents(".form-controls").find(".j-autosavePanel"),a=i.attr("type"),c=i.attr("name"),s=i.val();if("radio"==a){var l=$(e);$.ajax({url:n+"?v="+Math.round(100*Math.random()),type:"POST",dataType:"json",data:{name:c,value:s},beforeSend:function(){o.append(l)},success:function(e){l.fadeOut("fast",function(){if($(this).remove(),1==e.status){var n=$(t);o.append(n),n.animate({opacity:1},200,function(){setTimeout(function(){n.fadeOut("fast",function(){n.remove()})},200)})}else HYD.hint("danger","对不起，保存失败："+e.msg)})}})}});var i={};$(document).on("change",".j-checkbox-autosave",function(){var o=$(this),a=o.parents(".form-controls").find(".j-autosavePanel"),c=(o.attr("type"),o.attr("name")),s=function(){var i=[];$("input[name='"+c+"']").each(function(){$(this).is(":checked")&&i.push($(this).val())});var o=$(e);$.ajax({url:n+"?v="+Math.round(100*Math.random()),type:"POST",dataType:"json",data:{name:c,value:i},beforeSend:function(){a.append(o)},success:function(e){o.fadeOut("fast",function(){if($(this).remove(),1==e.status){var n=$(t);a.append(n),n.animate({opacity:1},200,function(){setTimeout(function(){n.fadeOut("fast",function(){n.remove()})},1e3)})}else HYD.hint("danger","对不起，保存失败："+e.msg)})}})};i[c]=null,i[c]&&clearTimeout(i[c]),i[c]=setTimeout(s,800)});var o=/^[\u4E00-\u9FA5_a-zA-Z0-9 ]{0,}$/;$(document).on("change",".j-text-autosave-judge",function(){var i=$(this),a=i.attr("name"),c=i.val(),s=(i.attr("placeholder"),$(e)),l=i.get(0).nextSibling,r=l?$(l):i;c?o.test(c)?$.ajax({url:n+"?v="+Math.round(100*Math.random()),type:"POST",dataType:"json",data:{name:a,value:c},beforeSend:function(){s.insertAfter(r)},success:function(e){s.fadeOut("fast",function(){if($(this).remove(),1==e.status){var n=$(t);n.insertAfter(r).animate({opacity:1},200,function(){setTimeout(function(){n.fadeOut("fast",function(){n.remove()})},1e3)})}else HYD.hint("danger","对不起，保存失败："+e.msg),setTimeout(function(){window.location.href=location.href+"?time="+(new Date).getTime()},2e3)})}}):(HYD.hint("danger","对不起，保存失败：不能输入除中英文以及数字外的特殊字符!"),setTimeout(function(){window.location.href=location.href+"?time="+(new Date).getTime()},2e3)):(HYD.hint("danger","对不起，保存失败：输入项不能为空!"),window.location.reload())});var a=/^([1-9]\d*|[0]{1,1})$/;$(".j-text-autosave-judge2").change(function(){var i=!0,o=$(this),c=o.attr("name"),s=o.val(),l=$(e),r=o.get(0).nextSibling,d=r?$(r):o;return""==s||a.test(s)?void(i&&$.ajax({url:n+"?v="+Math.round(100*Math.random()),type:"POST",dataType:"json",data:{name:c,value:s},beforeSend:function(){l.insertAfter(d)},success:function(e){l.fadeOut("fast",function(){if($(this).remove(),1==e.status){var n=$(t);n.insertAfter(d).animate({opacity:1},200,function(){setTimeout(function(){n.fadeOut("fast",function(){n.remove()})},1e3)})}else HYD.hint("danger","对不起，保存失败："+e.msg)})}})):(HYD.hint("danger","只能设置正整数（默认为0）!",1200),i=!1,!1)})}),$(function(){var e=$(".fixedBar").width();$(".fixedBar").height();$(".fixedBar").css({right:-e}),$("#j-fixedBar-btn").click(function(){$(".fixedBar").hasClass("show")?$(".fixedBar").animate({right:-e},"fast").removeClass("show"):$(".fixedBar").animate({right:5},"fast").addClass("show")}),$(".fixedBar>ul>li").click(function(e){$(this).addClass("cur").siblings("li").removeClass("cur")}),$(".fixedBar>ul>li").eq(0).addClass("cur");var t=$(".fixedBar>ul").children("li").length;if(0==t)$(".fixedBar").hide();else{var n=$(".left-menu"),i={};i.array_id=[],i.array_height=[],n.each(function(e,t){var n=$(this),o=$(this).children("dt").children("span"),a=o.data("id"),c=n.offset().top,s=n.outerHeight(!0),l=parseInt(c)+parseInt(s);i.array_id.push(a),i.array_height.push(l)});for(var o=0;o<i.array_height.length;o++){i.array_height[o];$(window).scroll(function(){$(window).scrollTop()})}$(window).scroll(function(e){for(var t=$(window).scrollTop(),n=0;n<i.array_height.length;n++){var o=i.array_height[n];if(0==n)t<o&&$(".shopManager"+i.array_id[n]).addClass("cur").siblings("li").removeClass("cur");else{var a=i.array_height[n-1];t>a&&t<o&&$(".shopManager"+i.array_id[n]).addClass("cur").siblings("li").removeClass("cur")}}})}$(".fixedBar>ul>li>a").click(function(e){var t=$(this),n=t.data("target"),i=$(n).offset().top;$.browser.chrome?elem="body":elem=document.documentElement||document.body,$(elem).animate({scrollTop:i},600)}),$("#j-showfixedBar").click(function(){$(this).fadeOut("fast"),$(".fixedBar").fadeIn("fast")})});